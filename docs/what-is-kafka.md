# ğŸ“¦ kafaë€? ìš°ì²´êµ­ì´ë‹¤ ?!
ìˆ˜ë§ì€ `íƒë°°`ë¥¼ ì•ˆì „í•˜ê²Œ ìˆœì°¨ì ìœ¼ë¡œ ì €ì¥í•´ ë‘ëŠ” `ìš°ì²´êµ­`ì…ë‹ˆë‹¤.  
`ë³´ë‚´ëŠ” ì‚¬ëŒ`ì´ `íƒë°°`ë¥¼ ë§¡ê¸°ë©´, `ìš°ì²´êµ­`ì€ ì´ë¥¼ ë¶„ì‹¤ ìœ„í—˜ ì—†ì´ `ëª©ì ì§€` ë³„ë¡œ ì°¨ê³¡ì°¨ê³¡ ìŒ“ì•„ë‘¡ë‹ˆë‹¤.  
`íƒë°°ë¥¼ ì°¾ëŠ” ì‚¬ëŒ`ì€ `íƒë°°`ë¥¼ ê°€ì ¸ê°ˆ ìˆ˜ ìˆì„ë•Œ `íƒë°°`ë¥¼ ì°¾ì„ ìˆ˜ ìˆì„ë•Œ `íƒë°°`ë¥¼ ê°€ì ¸ê°‘ë‹ˆë‹¤.
> ğŸ’¡ kafkaë¡œ ëŒ€ì…í•´ë³´ì!  
> ìˆ˜ë§ì€ `message`ë¥¼ ì•ˆì „í•˜ê²Œ ìˆœì°¨ì ìœ¼ë¡œ ì €ì¥í•´ ë‘ëŠ” `kafka`ì…ë‹ˆë‹¤.  
> `producer`ì´ `message`ë¥¼ ë§¡ê¸°ë©´, `kafka`ì€ ì´ë¥¼ ë¶„ì‹¤ ìœ„í—˜ ì—†ì´ `topic` ë³„ë¡œ ì°¨ê³¡ì°¨ê³¡ ìŒ“ì•„ë‘¡ë‹ˆë‹¤.  
> `consumer`ì€ `message`ë¥¼ ê°€ì ¸ê°ˆ ìˆ˜ ìˆì„ë•Œ `message`ë¥¼ ì°¾ì„ ìˆ˜ ìˆì„ë•Œ `message`ë¥¼ ê°€ì ¸ê°‘ë‹ˆë‹¤.

## ğŸ“Œ kafkaì˜ êµ¬ì„±ìš”ì†Œ
***`ë³´ë‚´ëŠ” ì‚¬ëŒ` = `producer`***  
- íƒë°°ë¥¼ ëª©ì ì§€ì— ë§¡ê¹ë‹ˆë‹¤.  

***`ëª©ì ì§€` = `topic`***   
- íƒë°°ë¥¼ ì €ì¥í•˜ëŠ” ê³µê°„ì´ë‹¤.  

***`ì„œë` = `partition`***   
- ê°™ì€ ëª©ì ì§€ë¥¼ ê°€ì§„ íƒë°°ë¥¼ ì„œëì— ì˜ ë¶„ë¦¬í•œë‹¤.  

***`ê´€ë¦¬ì§ì›` = `broker`***   
- íƒë°°ë¥¼ ê´€ë¦¬í•˜ëŠ” ì‚¬ëŒì´ë‹¤.  

***`íƒë°°ë¥¼ ì°¾ëŠ” ì‚¬ëŒ` = `consumer`***   
- ëª©ì ì§€ì— ë§ëŠ” íƒë°°ë¥¼ ì°¾ëŠ” ì‚¬ëŒì´ë‹¤.  
- íƒë°°ë¥¼ ì°¾ì„ ìˆ˜ ìˆì„ ë•Œ ì°¾ìœ¼ëŸ¬ ì˜¨ë‹¤.   

***`íƒë°°ë²ˆí˜¸` = `offset`***  
- íƒë°°ê°€ ì–´ë””ì— ìœ„ì¹˜í•´ ìˆëŠ”ì§€ ì•Œë ¤ì£¼ëŠ” ë²ˆí˜¸ì´ë‹¤.  

***`íƒë°°ë¥¼ ì°¾ëŠ” ì‚¬ëŒì˜ ê°€ì¡±` = `consumer-group`***  
- íƒë°°ë¥¼ ì°¾ëŠ” ì‚¬ëŒì˜ ê°€ì¡±ë“¤ì´ë‹¤.  

## ğŸ”„ kafkaì˜ íë¦„
1ï¸âƒ£ `producer`ê°€ `topic`ì— `message`ë¥¼ ë§¡ê¸´ë‹¤.  
2ï¸âƒ£ `broker`ê°€ `topic`ì˜ `partition`ì— ìˆœì‚¬ì²™ìœ¼ë¡œ ì €ì¥í•œë‹¤.  
3ï¸âƒ£ `consumer`ê°€ `topic`ì— `message`ë¥¼ ê°€ì ¸ê°„ë‹¤.
> ğŸ’¡ í•œë²ˆ ê°€ì ¸ê°„ `message` ë‹¤ë¥¸ `consumer`ì—ì„œë„ ì†Œë¹„ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.

> ğŸ’¡ í•œêº¼ë²ˆì— ì—¬ëŸ¬ê°œì˜ `message`ë„ ê°€ì ¸ê°ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤! 

## ğŸ«¢ kafkaê°€ ì¸ê¸°ìˆëŠ” ì´ìœ !!!
### 1ï¸âƒ£ ë°ì´í„°ë¥¼ ê¹”ë”í•˜ê²Œ ë¶„ë¥˜í•˜ê³ , ê´€ì‹¬ì‚¬ë¥¼ ë¶„ë¦¬í•  ìˆ˜ ìˆë‹¤.
Kafkaì˜ topic êµ¬ì¡° ë•ë¶„ì— `ì£¼ë¬¸`, `ê²°ì œ`, `ì•Œë¦¼`, `ë¡œê·¸` ë“± ì„œë¡œ ë‹¤ë¥¸ ë°ì´í„° íë¦„ì„ ê°ê°ì˜ `topic`ìœ¼ë¡œ ê¹”ë”í•˜ê²Œ ë¶„ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  
ê°ê°ì˜ íŒ€, ì„œë¹„ìŠ¤ëŠ” ìì‹ ì—ê²Œ í•„ìš”í•œ topicë§Œ ì‚¬ìš©í•˜ë©´ ë˜ë‹ˆ ê°œë°œ ìƒì‚°ì„±ì´ ì˜¬ë¼ê°‘ë‹ˆë‹¤.  
ìƒˆë¡œìš´ ì—…ë¬´ë‚˜ ë°ì´í„° íë¦„ì´ ìƒê²¨ë„ ê¸°ì¡´ íë¦„ì— ì˜í–¥ ì—†ì´ í™•ì¥ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.  
ì‹œìŠ¤í…œ ê°„ ê²°í•©ë„ë¥¼ ë‚®ì¶”ê³ , ì‘ì§‘ë„ë¥¼ ë†’í ìˆ˜ ìˆìŠµë‹ˆë‹¤.  
ì¥ì• ê°€ ì „íŒŒë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

### 2ï¸âƒ£ ì••ë„ì ì¸ ì„±ëŠ¥!!!
í•˜ë‚˜ì˜ `topic`ì„ ì—¬ëŸ¬ ê°œì˜ `partition`ìœ¼ë¡œ ë‚˜ëˆ„ì–´ ë°ì´í„°ë¥¼ ì—¬ëŸ¬ ì„œë²„ì— ë¶„ì‚° ì €ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.   
ìˆ˜ë§Œ, ìˆ˜ì‹­ë§Œ ê±´ì˜ ë©”ì‹œì§€ë„ ë™ì‹œì— ì²˜ë¦¬ ê°€ëŠ¥í•©ë‹ˆë‹¤.  
`consumer`ê°€ ë³‘ë ¬ë¡œ ë°ì´í„°ë¥¼ êº¼ë‚¼ ìˆ˜ ìˆë‹¤ â†’ ***ë³‘ëª© ì—†ëŠ” ê³ ì„±ëŠ¥***

> ğŸ’¡ `kafka`ëŠ” `topic`ìœ¼ë¡œ ë°ì´í„° íë¦„ì„ ê¹”ë”í•˜ê²Œ ë¶„ë¦¬í•˜ê³ , `partition`ìœ¼ë¡œ ì„±ëŠ¥ê³¼ ì•ˆì •ì„±ì„ ë³´ì¥í•©ë‹ˆë‹¤.  
> ì´ ë‘ ê°€ì§€ êµ¬ì¡° ë•ë¶„ì— `ì‹¤ì‹œê°„`, `ëŒ€ìš©ëŸ‰`, `ê³ ì‹ ë¢° ë°ì´í„° í”Œë«í¼`ì˜ ëŒ€í‘œì£¼ìê°€ ë˜ì—ˆìŠµë‹ˆë‹¤!

## ğŸ¤– kafka + spring + kotlin ì˜ˆì‹œ
### ğŸ“¨ Producer = ë©”ì‹œì§€ ë³´ë‚´ëŠ” ì‚¬ëŒ 
```kotlin
class LetterProducer(
    private val kafkaTemplate: KafkaTemplate<String, String>,
){
    fun send(){
        kafkaTemplate.send(topic, message)
    }
}
```
### ğŸ“© Consumer = ë©”ì‹œì§€ ë°›ëŠ” ì‚¬ëŒ
```kotlin
class LetterConsumer(
    private val consumerFactory: ConsumerFactory<String, ByteArray>
){
    fun consume(){
        consumerFactory.createConsumer().use { consumer ->
            consumer.subscribe(listOf(topic))
            val records = consumer.poll(Duration.ofSeconds(5))
        }
    }
}
```